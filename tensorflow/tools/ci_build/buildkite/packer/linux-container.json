{
    "variables": {
        "push_image": "{{env `PUSH_IMAGE`}}",
        "image_tag": "{{env `IMAGE_TAG`}}",
        "source_image": "{{env `SOURCE_IMAGE`}}"
    },
    "sensitive-variables": [
        "docker_repo_password"
    ],
    "builders": [{
        "type": "docker",
        "image": "{{user `source_image`}}",
        "commit": true,
        "changes": [
            "ENTRYPOINT /bin/bash"
        ]
    }],
    "provisioners": [{
        "type": "shell",
        "script": "linux-container.sh"
    }],
    "post-processors": [
        [{
            "type": "docker-tag",
            "repository": "{{user `push_image`}}",
            "tag": "{{user `image_tag`}}"
        }, {
            "type": "docker-push",
            "keep_input_artifact": true
        }]
    ]
}
